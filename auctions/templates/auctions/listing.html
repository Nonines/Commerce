<!-- Template for each Individual listing: -->

{% extends "auctions/layout.html" %}

{% block title %}{{ listing.title }}{% endblock %}

{% block body %}

    <div>
        <h3>{{ listing.title }}</h3>
        {{ listing.description }}
    </div>

    <div>
        <img style="width: 200px; height: 200px;" src="{{ listing.image }}" alt="Image">
    </div>

    <div>Seller: {{ listing.seller }}</div>

    <div>Category: {{ listing.category }}</div>

    <div>Starting Bid: {{ bid.starting_bid }}$</div>

    <div>Latest bid: {{ bid.offer }}$</div>

    <div>
        {{ bid.offer_count }} bid(s) so far.
        {% if user == bid.bidder %}
            <div>Your bid is the current bid.</div>
        {% endif %}
    </div>

    <!-- Watchlist -->
    <hr>

    <!-- If the Listing's owner is the current user,
        the watchlist form will not be rendered. -->
    {% if listing.seller != user %}
        <div>
            <form action="{% url 'watchlist' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="item_id" id="item_id" value="{{ listing.id }}">

                <!-- Picks which inputs to render, based on whether the
                    Listing can be found in the current user's Watchlist -->
                {% if listing not in watchlist %}
                    <input style="color: blue;" type="submit" value="Add to watchlist">
                    <input type="hidden" name="state" id="state" value="Add">
                {% else %}
                    <input style="color: red;" type="submit" value="Remove from watchlist">
                    <input type="hidden" name="state" id="state" value="Remove">
                {% endif %}
            </form>
        </div>

        <!-- Bidding -->
        <hr>

        <div>
            {{ message }}
            <form action="{% url 'listing' listing.id %}" method="post">
                {% csrf_token %}
                {{ form }}
                <input type="submit" value="Make a bid">
            </form>
        </div>
    {% endif %}

{% endblock %}
